(function(e,t,a,i){var n="ontouchstart"in t,o=n?"touchstart":"mousedown",u=n?"touchmove":"mousemove",l=n?"touchend":"mouseup",s=n?"touchcancel":"mouseup",d=function(e){var t=Math.floor(e/3600),a=Math.floor(e%3600/60),i=Math.ceil(e%3600%60);return(t==0?"":t>0&&t.toString().length<2?"0"+t+":":t+":")+(a.toString().length<2?"0"+a:a)+":"+(i.toString().length<2?"0"+i:i)},r=function(e){var t=a.createElement("audio");return!!(t.canPlayType&&t.canPlayType("audio/"+e.split(".").pop().toLowerCase()+";").replace(/no/,""))};e.fn.audioPlayer=function(t){var t=e.extend({classPrefix:"audioplayer",strPlay:"Play",strPause:"Pause",strVolume:"Volume"},t),a={},i={playPause:"playpause",playing:"playing",time:"time",timeCurrent:"time-current",timeDuration:"time-duration",bar:"bar",barLoaded:"bar-loaded",barPlayed:"bar-played",volume:"volume",volumeButton:"volume-button",volumeAdjust:"volume-adjust",noVolume:"novolume",mute:"mute",mini:"mini"};for(var l in i)a[l]=t.classPrefix+"-"+i[l];this.each(function(){if(e(this).prop("tagName").toLowerCase()!="audio")return false;var i=e(this),l=i.attr("src"),v=i.get(0).getAttribute("autoplay"),v=v===""||v==="autoplay"?true:false,m=i.get(0).getAttribute("loop"),m=m===""||m==="loop"?true:false,f=false;if(typeof l==="undefined"){i.find("source").each(function(){l=e(this).attr("src");if(typeof l!=="undefined"&&r(l)){f=true;return false}})}else if(r(l))f=true;var c=e('<div class="'+t.classPrefix+'">'+(f?e("<div>").append(i.eq(0).clone()).html():'<embed src="'+l+'" width="0" height="0" volume="100" autostart="'+v.toString()+'" loop="'+m.toString()+'" />')+'<div class="'+a.playPause+'" title="'+t.strPlay+'"><a href="#">'+t.strPlay+"</a></div></div>"),h=f?c.find("audio"):c.find("embed"),h=h.get(0);if(f){c.find("audio").css({width:0,height:0,visibility:"hidden"});c.append('<div class="'+a.time+" "+a.timeCurrent+'"></div><div class="'+a.bar+'"><div class="'+a.barLoaded+'"></div><div class="'+a.barPlayed+'"></div></div><div class="'+a.time+" "+a.timeDuration+'"></div><div class="'+a.volume+'"><div class="'+a.volumeButton+'" title="'+t.strVolume+'"><a href="#">'+t.strVolume+'</a></div><div class="'+a.volumeAdjust+'"><div><div></div></div></div></div>');var p=c.find("."+a.bar),y=c.find("."+a.barPlayed),g=c.find("."+a.barLoaded),b=c.find("."+a.timeCurrent),P=c.find("."+a.timeDuration),C=c.find("."+a.volumeButton),E=c.find("."+a.volumeAdjust+" > div"),w=0,L=function(e){theRealEvent=n?e.originalEvent.touches[0]:e;h.currentTime=Math.round(h.duration*(theRealEvent.pageX-p.offset().left)/p.width())},x=function(e){theRealEvent=n?e.originalEvent.touches[0]:e;h.volume=Math.abs((theRealEvent.pageY-(E.offset().top+E.height()))/E.height())},M=setInterval(function(){g.width(h.buffered.end(0)/h.duration*100+"%");if(h.buffered.end(0)>=h.duration)clearInterval(M)},100);var S=h.volume,V=h.volume=.111;if(Math.round(h.volume*1e3)/1e3==V)h.volume=S;else c.addClass(a.noVolume);P.html("&hellip;");b.text(d(0));h.addEventListener("loadeddata",function(){P.text(d(h.duration));E.find("div").height(h.volume*100+"%");w=h.volume});h.addEventListener("timeupdate",function(){b.text(d(h.currentTime));y.width(h.currentTime/h.duration*100+"%")});h.addEventListener("volumechange",function(){E.find("div").height(h.volume*100+"%");if(h.volume>0&&c.hasClass(a.mute))c.removeClass(a.mute);if(h.volume<=0&&!c.hasClass(a.mute))c.addClass(a.mute)});h.addEventListener("ended",function(){c.removeClass(a.playing)});p.on(o,function(e){L(e);p.on(u,function(e){L(e)})}).on(s,function(){p.unbind(u)});C.on("click",function(){if(c.hasClass(a.mute)){c.removeClass(a.mute);h.volume=w}else{c.addClass(a.mute);w=h.volume;h.volume=0}return false});E.on(o,function(e){x(e);E.on(u,function(e){x(e)})}).on(s,function(){E.unbind(u)})}else c.addClass(a.mini);if(v)c.addClass(a.playing);c.find("."+a.playPause).on("click",function(){if(c.hasClass(a.playing)){e(this).attr("title",t.strPlay).find("a").html(t.strPlay);c.removeClass(a.playing);f?h.pause():h.Stop()}else{e(this).attr("title",t.strPause).find("a").html(t.strPause);c.addClass(a.playing);f?h.play():h.Play()}return false});i.replaceWith(c)});return this}})(jQuery,window,document);